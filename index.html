<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦ç››åœ’è— - 2026è¥¿æ´‹æƒ…äººç¯€é è³¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .product-img { aspect-ratio: 1 / 1.1; object-fit: contain; }
        .qty-input::-webkit-inner-spin-button { opacity: 1; }
        .sticky-footer { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px); }
        /* é‡å°æˆªåœ–å„ªåŒ–çš„æ¨£å¼ */
        .order-slip { border: 2px solid #e2e8f0; border-radius: 1rem; padding: 1.5rem; background: #fff; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-6 px-3 pb-32">
    <div class="max-w-4xl mx-auto">
        
        <section id="noticeSection" class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-8 text-sm text-gray-700">
            <h1 class="text-2xl font-bold text-rose-600 text-center mb-4">ğŸŒ¹ 2026 è¥¿æ´‹æƒ…äººç¯€é è³¼</h1>
            <div class="grid md:grid-cols-2 gap-6 border-t pt-4">
                <div>
                    <p class="font-bold text-gray-900 mb-2">ã€è¨‚è³¼é ˆçŸ¥ã€‘</p>
                    <ul class="list-disc ml-4 space-y-1 text-xs">
                        <li>åœ‹å¤–é€²å‡ºå£ç«ç‘°æœ‰å…¶é‹è¼¸é¢¨éšªï¼Œè«‹è¡¡é‡è¨‚è³¼ã€‚</li>
                        <li>ç«ç‘°ç›®å‰é è¨ˆ2/8æ™šä¸ŠæŠµå°ï¼Œç­æ©Ÿå»¶èª¤å±¬é¢¨éšªç¯„åœã€‚<span class="text-rose-600 font-bold">é–‹æ”¾å–è²¨æ™‚é–“ç‚ºï¼š2/9è‡³2/12ï¼Œä¸¦è«‹ç•™æ„ 2/11 èŠ±å¸‚å…¬ä¼‘æœªç‡Ÿæ¥­ä¸é–‹æ”¾å–è²¨</span> ï¼Œç”±æ–¼æœ¬æ¬¡åˆ°è²¨æœŸé–“é©é€¢å°åŒ—èŠ±å¸‚ 24 å°æ™‚ç‡Ÿæ¥­ï¼Œé€²å£ç«ç‘°æ¡é™é‡é è³¼ï¼Œè«‹ç•™æ„è¡¨å–®å¡«å¯«ä»¥åŠåŒ¯æ¬¾æ™‚é–“</li>
                        <li>é è¨‚å®Œæˆå¾Œ <span class="underline">ç„¡æ³•å–æ¶ˆé€€æ¬¾</span>ï¼Œè¨‚è³¼å‰è«‹ç¢ºèªå…§å®¹ã€‚</li>
                        <li>åŸå°åŸè£æè€—ç´„ 1â€“2 æ”¯å±¬æ­£å¸¸ç¯„åœã€‚</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-3 rounded-xl border border-gray-200">
                    <p class="font-bold text-gray-900 mb-1">ğŸ’° åŒ¯æ¬¾è³‡è¨Š</p>
                    <p class="text-xs italic mb-2">åŒ¯æ¬¾å¾Œè«‹æˆªåœ–å‚³è‡³ LINE å®˜æ–¹å¸³è™Ÿ</p>
                    <p class="text-xs">éŠ€è¡Œï¼š(101) ç‘èˆˆéŠ€è¡Œ</p>
                    <p class="text-xs">å¸³è™Ÿï¼š0127221335660</p>
                </div>
            </div>
            <div class="mt-4 text-center">
                <a href="https://lin.ee/TDtujRf" target="_blank" class="text-green-600 font-bold underline">ğŸ‘‰ é»æ­¤è¯ç¹«ç¦ç››å®˜æ–¹ LINE</a>
            </div>
        </section>

        <form id="orderForm">
            <section class="bg-white rounded-2xl shadow-sm p-6 mb-8 border border-gray-100">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <span class="w-1 h-6 bg-rose-500 mr-2 rounded-full"></span> è¨‚è³¼äººè³‡è¨Š
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-3 mb-2">
                        <label class="flex items-center space-x-2 p-2 bg-rose-50 rounded-lg cursor-pointer border border-rose-100">
                            <input type="checkbox" id="terms" class="w-4 h-4 accent-rose-500" required>
                            <span class="text-sm font-bold text-rose-600">æˆ‘å·²é–±è®€ä¸¦åŒæ„ä¸Šè¿°è¨‚è³¼é ˆçŸ¥</span>
                        </label>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">å§“å</label>
                        <input type="text" name="customerName" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-400 transition" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">é›»è©±</label>
                        <input type="tel" name="customerPhone" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-400 transition" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">é›»å­éƒµä»¶</label>
                        <input type="email" name="customerEmail" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-400 transition" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">è¯çµ¡æ–¹å¼</label>
                        <div class="flex space-x-4 mt-1">
                            <label class="inline-flex items-center"><input type="radio" name="contactType" value="Facebook" class="accent-rose-500" required><span class="ml-1 text-sm">FB</span></label>
                            <label class="inline-flex items-center"><input type="radio" name="contactType" value="Instagram" class="accent-rose-500"><span class="ml-1 text-sm">IG</span></label>
                            <label class="inline-flex items-center"><input type="radio" name="contactType" value="LINE" class="accent-rose-500"><span class="ml-1 text-sm">LINE</span></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">è©³ç´°è¯çµ¡è³‡è¨Š (ID/å¸³è™Ÿ)</label>
                        <input type="text" name="contactDetail" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-400 transition" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1 text-rose-500 font-bold">é è¨ˆå–è²¨æ—¥ (é–‹æ”¾2/9-2/12å–è²¨ï¼Œè«‹æ³¨æ„å°åŒ—èŠ±å¸‚2/11å…¬ä¼‘)</label>
                        <input type="date" name="pickupDate" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-400 transition" required>
                    </div>
                </div>
            </section>

            <h2 class="text-xl font-bold mb-6 flex items-center px-2 text-gray-800">
                ğŸ“¦ è¨‚è³¼å…§å®¹
            </h2>
            <div id="productList" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-10">
                <p class="col-span-full text-center py-20 text-gray-400 animate-pulse">æ­£åœ¨åŒæ­¥å“é …...</p>
            </div>

            <section class="bg-white rounded-2xl shadow-sm p-6 mb-8 border border-gray-100">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <span class="w-1 h-6 bg-rose-500 mr-2 rounded-full"></span> é…é€æ–¹å¼
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm">
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å°åŒ—èŠ±å¸‚è‡ªå–" data-fee="0" class="w-4 h-4 accent-rose-500" required checked>
                        <span class="ml-2">å°åŒ—èŠ±å¸‚ (è‡ªå–) - å…é‹</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å®…é…" data-fee="0" class="w-4 h-4 accent-rose-500">
                        <span class="ml-2">å®…é… (å¾…å ±åƒ¹)</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å›é ­è»Š" id="shipBackhaul" class="w-4 h-4 accent-rose-500">
                        <span class="ml-2 font-bold text-rose-600">å›é ­è»Šé…é€</span>
                    </label>
                </div>
                <div id="backhaulOptions" class="hidden mt-4 pt-4 border-t border-gray-100">
                    <select id="backhaulLocation" class="w-full border-gray-200 border p-3 rounded-xl bg-gray-50 outline-none">
                        <option value="" data-fee="0">è«‹é¸æ“‡å›é ­è»Šåœ°é»</option>
                    </select>
                </div>
            </section>

            <section class="sticky-footer fixed bottom-4 left-4 right-4 max-w-2xl mx-auto border-2 border-rose-500 rounded-3xl shadow-2xl p-5 z-40">
                <div id="summaryContainer" class="mb-3 text-[11px] text-gray-500 space-y-1 max-h-24 overflow-y-auto border-b pb-2 hidden">
                    </div>
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider">Total Amount</p>
                        <p id="finalTotal" class="text-3xl font-black text-rose-600">$0</p>
                    </div>
                    <button type="submit" id="submitBtn" class="bg-rose-600 text-white px-10 py-3 rounded-2xl font-bold text-lg hover:bg-rose-700 shadow-lg transition-transform active:scale-95">
                        ç¢ºèªé€å‡º
                    </button>
                </div>
            </section>
        </form>

        <div id="successPage" class="hidden fixed inset-0 bg-white z-50 overflow-y-auto p-4 md:p-8">
            <div class="max-w-2xl mx-auto">
                <div class="text-center mb-6">
                    <div class="text-5xl mb-2">âœ…</div>
                    <h2 class="text-2xl font-black text-rose-600 uppercase tracking-widest">é è³¼å–®å·²é€å‡º</h2>
                    <p class="text-gray-400 text-xs">è«‹æˆªåœ–æ­¤ç•«é¢ä¸¦è‡³ LINE å›å‚³åŒ¯æ¬¾è­‰æ˜</p>
                </div>

                <div class="order-slip shadow-xl border-2 border-gray-100">
                    <div class="flex justify-between items-start border-b pb-4 mb-4">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800">ç¦ç››åœ’è— - é è³¼å‡ºè²¨å–®</h3>
                            <p class="text-[10px] text-gray-400" id="orderTimestamp"></p>
                        </div>
                        <div class="text-right">
                            <span class="bg-rose-100 text-rose-600 text-[10px] px-2 py-1 rounded-full font-bold">2026è¥¿æ´‹æƒ…äººç¯€</span>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-y-2 text-sm mb-6 bg-gray-50 p-3 rounded-xl">
                        <div><span class="text-gray-400 mr-2">å§“å:</span><span id="resName" class="font-bold"></span></div>
                        <div><span class="text-gray-400 mr-2">é›»è©±:</span><span id="resPhone" class="font-bold"></span></div>
                        <div class="col-span-2"><span class="text-gray-400 mr-2">è¯çµ¡:</span><span id="resContact" class="font-bold"></span></div>
                        <div><span class="text-gray-400 mr-2">å–è²¨:</span><span id="resDate" class="font-bold"></span></div>
                        <div><span class="text-gray-400 mr-2">é…é€:</span><span id="resShip" class="font-bold"></span></div>
                    </div>

                    <div class="mb-6">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-gray-400 text-left border-b text-[10px] uppercase">
                                    <th class="pb-2">å“å</th>
                                    <th class="pb-2 text-center">æ•¸é‡</th>
                                    <th class="pb-2 text-right">å°è¨ˆ</th>
                                </tr>
                            </thead>
                            <tbody id="resItemsList">
                                </tbody>
                        </table>
                    </div>

                    <div class="border-t pt-4 text-right">
                        <p class="text-xs text-gray-500">æ‡‰åŒ¯ç¸½é‡‘é¡ (å«é‹è²»)</p>
                        <p id="resTotal" class="text-4xl font-black text-rose-600"></p>
                    </div>

                    <div class="mt-8 pt-6 border-t border-dashed border-gray-200">
                        <div class="bg-rose-50 p-4 rounded-2xl border border-rose-100">
                            <h4 class="text-xs font-bold text-rose-600 mb-2">ğŸ’° åŒ¯æ¬¾å¸³æˆ¶</h4>
                            <p class="text-sm font-bold text-gray-700">éŠ€è¡Œï¼šç‘èˆˆéŠ€è¡Œ (101)</p>
                            <p class="text-sm font-bold text-gray-700">å¸³è™Ÿï¼š0127221335660</p>
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex flex-col space-y-4">
                    <a href="https://lin.ee/TDtujRf" target="_blank" class="bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg flex items-center justify-center space-x-2">
                        <span>é–‹å•Ÿ LINE å›å‚³æˆªåœ–</span>
                    </a>
                    <button onclick="location.reload()" class="text-gray-400 underline text-xs">è¿”å›ä¿®æ”¹è³‡æ–™</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzgJTRoha4m44NHZ8HrcJKcyKOc2IFprotnA4PPhDSONVVWNxfMB_jXksTxbFewm67Y/exec';
        const backhaulData = {
            "æ¡ƒåœ’ä½³æ¬£èŠ±åº—": 0, "ç«¹åŒ—æ¿±æ±Ÿæ—èŠ±åº—": 150, "è‹—æ —äº¤æµé“": 150, "å°ä¸­èŠ³æ—èŠ±å‰": 150,
            "å°ä¸­æ±ŸåˆèŠ±å¸‚": 200, "è±åŸäº¤æµé“": 150, "å½°åŒ–ç”°å°¾èŠ±å¸‚": 150, "è‰å±¯äº¤æµé“": 200,
            "åŸ”é‡Œé®ä¿¡ç¾©è·¯100è™Ÿ": 200, "æ–—å—äº¤æµé“": 200, "å˜‰ç¾©äº¤æµé“": 200, "æ°´ä¸Šäº¤æµé“": 200,
            "æ–°ç‡Ÿäº¤æµé“": 200, "å°å—èŠ±å¸‚": 200, "ä»å¾·äº¤æµé“": 200, "æ¥ æ¢“äº¤æµé“": 200,
            "é«˜é›„å°šé™¶åŠèŠ±åº—": 200, "é«˜é›„èŠ±å¸‚": 200, "å±æ±åœ‹èŠ³èŠ±åº—": 200
        };

        let productData = [];
        const productList = document.getElementById('productList');
        const backhaulSelect = document.getElementById('backhaulLocation');

        Object.keys(backhaulData).forEach(loc => {
            const opt = document.createElement('option');
            opt.value = loc;
            opt.textContent = `${loc} (+$${backhaulData[loc]})`;
            opt.dataset.fee = backhaulData[loc];
            backhaulSelect.appendChild(opt);
        });

        fetch(scriptURL)
            .then(res => res.json())
            .then(data => {
                productData = data;
                productList.innerHTML = '';
                data.forEach((p, i) => {
                    const card = `
                        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-3 flex flex-col items-center">
                            <img src="${p.img}" class="product-img w-full mb-3 rounded-xl">
                            <h3 class="text-rose-600 font-black text-lg leading-tight">${p.series}</h3>
                            <p class="text-[12px] font-bold text-gray-700 h-9 overflow-hidden text-center mt-1 leading-tight">${p.name}</p>
                            <p class="text-green-600 font-bold text-sm mt-1">NT$${p.price}</p>
                            <div class="w-full flex items-center justify-between pt-3 border-t border-gray-50 mt-3">
                                <span class="text-[10px] text-gray-400 font-bold uppercase">Qty</span>
                                <input type="number" data-index="${i}" value="0" min="0" 
                                    class="qty-input w-14 border rounded-lg py-1 text-center font-bold text-gray-800 focus:border-rose-400 outline-none transition">
                            </div>
                        </div>
                    `;
                    productList.innerHTML += card;
                });
                setupListeners();
            });

        function setupListeners() {
            document.querySelectorAll('.qty-input, input[name="shippingMethod"], #backhaulLocation').forEach(el => {
                el.addEventListener('change', calculateTotal);
                el.addEventListener('input', calculateTotal);
            });
        }

        function calculateTotal() {
            let subtotal = 0;
            let summaryHtml = '';
            document.querySelectorAll('.qty-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    const p = productData[input.dataset.index];
                    subtotal += qty * p.price;
                    summaryHtml += `<div class="flex justify-between"><span>${p.name} x ${qty}</span><span>$${qty * p.price}</span></div>`;
                }
            });

            const shipMethod = document.querySelector('input[name="shippingMethod"]:checked').value;
            let shipFee = 0;
            if (shipMethod === 'å›é ­è»Š') {
                document.getElementById('backhaulOptions').classList.remove('hidden');
                shipFee = parseInt(backhaulSelect.selectedOptions[0].dataset.fee) || 0;
            } else {
                document.getElementById('backhaulOptions').classList.add('hidden');
            }

            const total = subtotal + shipFee;
            document.getElementById('finalTotal').textContent = `$${total}`;
            
            const container = document.getElementById('summaryContainer');
            if (summaryHtml) {
                container.innerHTML = summaryHtml + `<div class="border-t mt-1 pt-1 text-rose-500 font-bold">é…é€è²»: ${shipMethod} (+$${shipFee})</div>`;
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const items = [];
            document.querySelectorAll('.qty-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    const p = productData[input.dataset.index];
                    items.push({ name: p.name, price: p.price, quantity: qty });
                }
            });

            if (items.length === 0) return alert('è«‹å…ˆè¼¸å…¥è¨‚è³¼æ•¸é‡ï¼');
            if (!document.getElementById('terms').checked) return alert('è«‹å…ˆå‹¾é¸åŒæ„è¨‚è³¼é ˆçŸ¥');

            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.textContent = 'è¨‚å–®å‚³é€ä¸­...';

            const shippingOption = document.querySelector('input[name="shippingMethod"]:checked');
            const totalVal = document.getElementById('finalTotal').textContent;

            const payload = {
                customer: {
                    name: this.customerName.value,
                    phone: this.customerPhone.value,
                    email: this.customerEmail.value,
                    contactType: document.querySelector('input[name="contactType"]:checked').value,
                    contactDetail: this.contactDetail.value,
                    pickupDate: this.pickupDate.value
                },
                items: items,
                shipping: {
                    method: shippingOption.value,
                    location: shippingOption.value === 'å›é ­è»Š' ? backhaulSelect.value : 'N/A',
                    fee: shippingOption.value === 'å›é ­è»Š' ? parseInt(backhaulSelect.selectedOptions[0].dataset.fee) : 0
                },
                totalWithShipping: parseInt(totalVal.replace('$', ''))
            };

            fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) })
            .then(() => {
                // æˆåŠŸå¾Œé¡¯ç¤ºå‡ºè²¨å–®
                document.getElementById('resName').textContent = payload.customer.name;
                document.getElementById('resPhone').textContent = payload.customer.phone;
                document.getElementById('resContact').textContent = `(${payload.customer.contactType}) ${payload.customer.contactDetail}`;
                document.getElementById('resDate').textContent = payload.customer.pickupDate;
                document.getElementById('resShip').textContent = payload.shipping.method === 'å›é ­è»Š' ? `å›é ­è»Š - ${payload.shipping.location}` : payload.shipping.method;
                document.getElementById('orderTimestamp').textContent = 'è¨‚å–®æ™‚é–“: ' + new Date().toLocaleString();
                document.getElementById('resTotal').textContent = totalVal;

                let itemsHtml = '';
                payload.items.forEach(item => {
                    itemsHtml += `<tr class="border-b border-gray-50"><td class="py-3">${item.name}</td><td class="py-3 text-center">x ${item.quantity}</td><td class="py-3 text-right font-bold">$${item.price * item.quantity}</td></tr>`;
                });
                // åŠ å…¥é‹è²»åˆ—
                if (payload.shipping.fee > 0) {
                    itemsHtml += `<tr class="text-rose-500 font-bold"><td class="py-3">é‹è²» (${payload.shipping.location})</td><td></td><td class="py-3 text-right">+$${payload.shipping.fee}</td></tr>`;
                }

                document.getElementById('resItemsList').innerHTML = itemsHtml;
                document.getElementById('successPage').classList.remove('hidden');
                window.scrollTo(0,0);
            });
        });
    </script>
</body>
</html>
