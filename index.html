<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦ç››åœ’è— - 2026è¥¿æ´‹æƒ…äººç¯€é è³¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .product-img { aspect-ratio: 1 / 1.1; object-fit: contain; }
        .qty-input::-webkit-inner-spin-button { opacity: 1; }
        .sticky-footer { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px); }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-6 px-3 pb-32">
    <div class="max-w-4xl mx-auto">
        
        <section class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-8 text-sm text-gray-700">
            <h1 class="text-2xl font-bold text-rose-600 text-center mb-4">ğŸŒ¹ 2026 è¥¿æ´‹æƒ…äººç¯€é è³¼</h1>
            <div class="grid md:grid-cols-2 gap-6 border-t pt-4">
                <div>
                    <p class="font-bold text-gray-900 mb-2">ã€è¨‚è³¼é ˆçŸ¥ã€‘</p>
                    <ul class="list-disc ml-4 space-y-1 text-xs">
                        <li>åœ‹å¤–é€²å‡ºå£ç«ç‘°æœ‰å…¶é‹è¼¸é¢¨éšªï¼Œè«‹è¡¡é‡è¨‚è³¼ã€‚</li>
                        <li>ç«ç‘°é è¨ˆ <span class="text-rose-600">OO/OO</span> æŠµå°ï¼Œç­æ©Ÿå»¶èª¤å±¬é¢¨éšªç¯„åœã€‚</li>
                        <li>é è¨‚å®Œæˆå¾Œ <span class="underline">ç„¡æ³•å–æ¶ˆé€€æ¬¾</span>ã€‚</li>
                        <li>åŸå°åŸè£æè€—ç´„ 1â€“2 æ”¯å±¬æ­£å¸¸ç¯„åœã€‚</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-3 rounded-xl border border-gray-200">
                    <p class="font-bold text-gray-900 mb-1">ğŸ’° åŒ¯æ¬¾è³‡è¨Š</p>
                    <p class="text-xs italic mb-2">åŒ¯æ¬¾å¾Œè«‹æˆªåœ–å‚³è‡³ LINE å®˜æ–¹å¸³è™Ÿ</p>
                    <p class="text-xs">éŠ€è¡Œï¼š(101) ç‘èˆˆéŠ€è¡Œ</p>
                    <p class="text-xs">å¸³è™Ÿï¼š0127221335660</p>
                </div>
            </div>
            <div class="mt-4 text-center">
                <a href="https://line.me/R/ti/p/@087pqqof" target="_blank" class="text-green-600 font-bold underline">ğŸ‘‰ é»æ­¤è¯ç¹«ç¦ç››å®˜æ–¹ LINE</a>
            </div>
        </section>

        <form id="orderForm">
            <section class="bg-white rounded-2xl shadow-sm p-6 mb-8">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <span class="w-1 h-6 bg-rose-500 mr-2 rounded-full"></span> è¨‚è³¼äººè³‡è¨Š
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-3 mb-2">
                        <label class="flex items-center space-x-2 p-2 bg-rose-50 rounded-lg cursor-pointer">
                            <input type="checkbox" id="terms" class="w-4 h-4 accent-rose-500" required>
                            <span class="text-sm font-bold text-rose-600">æˆ‘å·²é–±è®€ä¸¦åŒæ„ä¸Šè¿°è¨‚è³¼é ˆçŸ¥</span>
                        </label>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">å§“å</label>
                        <input type="text" name="customerName" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-300" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">é›»è©±</label>
                        <input type="tel" name="customerPhone" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-300" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">é›»å­éƒµä»¶</label>
                        <input type="email" name="customerEmail" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-300" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">è¯çµ¡æ–¹å¼</label>
                        <select name="contactType" class="w-full border-gray-200 border p-2 rounded-lg bg-white outline-none">
                            <option value="LINE">LINE</option>
                            <option value="Facebook">Facebook</option>
                            <option value="Instagram">Instagram</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">è©³ç´°è¯çµ¡è³‡è¨Š (ID/å¸³è™Ÿ)</label>
                        <input type="text" name="contactDetail" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-300" required>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1 text-rose-500 font-bold">é è¨ˆå–è²¨æ—¥ (ç«ç‘°é è¨ˆOO/OOæŠµå°)</label>
                        <input type="date" name="pickupDate" class="w-full border-gray-200 border p-2 rounded-lg outline-none focus:border-rose-300" required>
                    </div>
                </div>
            </section>

            <h2 class="text-xl font-bold mb-6 flex items-center px-2 text-gray-800">
                ğŸ“¦ è¨‚è³¼å…§å®¹
            </h2>
            <div id="productList" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-10">
                <p class="col-span-full text-center py-20 text-gray-400 animate-pulse">æ­£åœ¨åŒæ­¥å“é …...</p>
            </div>

            <section class="bg-white rounded-2xl shadow-sm p-6 mb-8">
                <h2 class="text-lg font-bold mb-4 flex items-center">
                    <span class="w-1 h-6 bg-rose-500 mr-2 rounded-full"></span> é…é€æ–¹å¼
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm">
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å°åŒ—èŠ±å¸‚è‡ªå–" data-fee="0" class="w-4 h-4 accent-rose-500" required checked>
                        <span class="ml-2">å°åŒ—èŠ±å¸‚ (è‡ªå–) - å…é‹</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å®…é…" data-fee="0" class="w-4 h-4 accent-rose-500">
                        <span class="ml-2">å®…é… (å¾…å ±åƒ¹)</span>
                    </label>
                    <label class="flex items-center p-3 border rounded-xl cursor-pointer hover:bg-rose-50 transition border-gray-200">
                        <input type="radio" name="shippingMethod" value="å›é ­è»Š" id="shipBackhaul" class="w-4 h-4 accent-rose-500">
                        <span class="ml-2 font-bold text-rose-600">å›é ­è»Šé…é€</span>
                    </label>
                </div>
                <div id="backhaulOptions" class="hidden mt-4 pt-4 border-t border-gray-100">
                    <select id="backhaulLocation" class="w-full border-gray-200 border p-3 rounded-xl bg-gray-50 outline-none">
                        <option value="" data-fee="0">è«‹é¸æ“‡å›é ­è»Šåœ°é»</option>
                    </select>
                </div>
            </section>

            <section class="sticky-footer fixed bottom-4 left-4 right-4 max-w-2xl mx-auto border-2 border-rose-500 rounded-3xl shadow-2xl p-5 z-40">
                <div id="summaryContainer" class="mb-3 text-[11px] text-gray-500 space-y-1 max-h-24 overflow-y-auto border-b pb-2 hidden">
                    </div>
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider">Estimated Total</p>
                        <p id="finalTotal" class="text-3xl font-black text-rose-600">$0</p>
                    </div>
                    <button type="submit" id="submitBtn" class="bg-rose-600 text-white px-10 py-3 rounded-2xl font-bold text-lg hover:bg-rose-700 shadow-lg transition-transform active:scale-95">
                        ç¢ºèªé€å‡º
                    </button>
                </div>
            </section>
        </form>

        <div id="successPage" class="hidden fixed inset-0 bg-white z-50 flex flex-col items-center justify-center p-6 text-center">
            <div class="text-6xl mb-4">âœ…</div>
            <h2 class="text-2xl font-bold text-rose-600 mb-2">é è³¼å–®å·²é€å‡ºï¼</h2>
            <p class="text-gray-500 mb-6 font-bold text-sm">æ‡‰åŒ¯ç¸½é‡‘é¡ï¼š<span id="remitAmount" class="text-2xl text-rose-600 font-black"></span></p>
            <div class="bg-gray-50 p-6 rounded-2xl border border-gray-200 text-left mb-8 w-full max-w-xs">
                <p class="text-sm mb-1"><b>éŠ€è¡Œï¼š</b>ç‘èˆˆéŠ€è¡Œ (101)</p>
                <p class="text-sm mb-1"><b>å¸³è™Ÿï¼š</b>0127221335660</p>
                <p class="text-[11px] text-rose-500 mt-3 font-medium">â€» è«‹æˆªåœ–æ­¤ç•«é¢ä¸¦è‡³ LINE å›å‚³åŒ¯æ¬¾è­‰æ˜ã€‚</p>
            </div>
            <a href="https://line.me/R/ti/p/@087pqqof" target="_blank" class="w-full max-w-xs bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg mb-4 flex items-center justify-center">
                é–‹å•Ÿ LINE å›å‚³æˆªåœ–
            </a>
            <button onclick="location.reload()" class="text-gray-400 underline text-xs">è¿”å›ä¿®æ”¹è³‡æ–™</button>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzgJTRoha4m44NHZ8HrcJKcyKOc2IFprotnA4PPhDSONVVWNxfMB_jXksTxbFewm67Y/exec';
        const backhaulData = {
            "æ¡ƒåœ’ä½³æ¬£èŠ±åº—": 0, "ç«¹åŒ—æ¿±æ±Ÿæ—èŠ±åº—": 150, "è‹—æ —äº¤æµé“": 150, "å°ä¸­èŠ³æ—èŠ±å‰": 150,
            "å°ä¸­æ±ŸåˆèŠ±å¸‚": 200, "è±åŸäº¤æµé“": 150, "å½°åŒ–ç”°å°¾èŠ±å¸‚": 150, "è‰å±¯äº¤æµé“": 200,
            "åŸ”é‡Œé®ä¿¡ç¾©è·¯100è™Ÿ": 200, "æ–—å—äº¤æµé“": 200, "å˜‰ç¾©äº¤æµé“": 200, "æ°´ä¸Šäº¤æµé“": 200,
            "æ–°ç‡Ÿäº¤æµé“": 200, "å°å—èŠ±å¸‚": 200, "ä»å¾·äº¤æµé“": 200, "æ¥ æ¢“äº¤æµé“": 200,
            "é«˜é›„å°šé™¶åŠèŠ±åº—": 200, "é«˜é›„èŠ±å¸‚": 200, "å±æ±åœ‹èŠ³èŠ±åº—": 200
        };

        let productData = [];
        const productList = document.getElementById('productList');
        const backhaulSelect = document.getElementById('backhaulLocation');

        // åˆå§‹åŒ–å›é ­è»Šåœ°é»
        Object.keys(backhaulData).forEach(loc => {
            const opt = document.createElement('option');
            opt.value = loc;
            opt.textContent = `${loc} (+$${backhaulData[loc]})`;
            opt.dataset.fee = backhaulData[loc];
            backhaulSelect.appendChild(opt);
        });

        // è¼‰å…¥è©¦ç®—è¡¨å“é …
        fetch(scriptURL)
            .then(res => res.json())
            .then(data => {
                productData = data;
                productList.innerHTML = '';
                data.forEach((p, i) => {
                    const card = `
                        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-3 flex flex-col items-center">
                            <img src="${p.img}" class="product-img w-full mb-3 rounded-xl">
                            <h3 class="text-rose-600 font-black text-lg leading-tight">${p.series}</h3>
                            <p class="text-[12px] font-bold text-gray-700 h-9 overflow-hidden text-center mt-1 leading-tight">${p.name}</p>
                            <p class="text-green-600 font-bold text-sm mt-1">NT$${p.price}</p>
                            <div class="w-full flex items-center justify-between pt-3 border-t border-gray-50 mt-3">
                                <span class="text-[10px] text-gray-400 font-bold uppercase">Qty</span>
                                <input type="number" data-index="${i}" value="0" min="0" 
                                    class="qty-input w-14 border rounded-lg py-1 text-center font-bold text-gray-800 focus:border-rose-400 outline-none transition">
                            </div>
                        </div>
                    `;
                    productList.innerHTML += card;
                });
                setupListeners();
            });

        function setupListeners() {
            document.querySelectorAll('.qty-input, input[name="shippingMethod"], #backhaulLocation').forEach(el => {
                el.addEventListener('change', calculateTotal);
                el.addEventListener('input', calculateTotal);
            });
        }

        function calculateTotal() {
            let subtotal = 0;
            let summaryHtml = '';
            document.querySelectorAll('.qty-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    const p = productData[input.dataset.index];
                    subtotal += qty * p.price;
                    summaryHtml += `<div class="flex justify-between"><span>${p.name} x ${qty}</span><span>$${qty * p.price}</span></div>`;
                }
            });

            const shipMethod = document.querySelector('input[name="shippingMethod"]:checked').value;
            let shipFee = 0;
            if (shipMethod === 'å›é ­è»Š') {
                document.getElementById('backhaulOptions').classList.remove('hidden');
                shipFee = parseInt(backhaulSelect.selectedOptions[0].dataset.fee) || 0;
            } else {
                document.getElementById('backhaulOptions').classList.add('hidden');
            }

            const total = subtotal + shipFee;
            document.getElementById('finalTotal').textContent = `$${total}`;
            document.getElementById('remitAmount').textContent = `$${total}`;
            
            const container = document.getElementById('summaryContainer');
            if (summaryHtml) {
                container.innerHTML = summaryHtml + `<div class="border-t mt-1 pt-1 text-rose-500 font-bold">é…é€è²»: ${shipMethod} (+$${shipFee})</div>`;
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        // æäº¤è™•ç†
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const items = [];
            document.querySelectorAll('.qty-input').forEach(input => {
                const qty = parseInt(input.value) || 0;
                if (qty > 0) {
                    const p = productData[input.dataset.index];
                    items.push({ name: p.name, price: p.price, quantity: qty });
                }
            });

            if (items.length === 0) return alert('è«‹å…ˆå¡«å¯«è¨‚è³¼æ•¸é‡ï¼');
            if (!document.getElementById('terms').checked) return alert('è«‹å…ˆå‹¾é¸åŒæ„è¨‚è³¼é ˆçŸ¥');

            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.textContent = 'å‚³é€ä¸­...';

            const shippingOption = document.querySelector('input[name="shippingMethod"]:checked');
            const payload = {
                customer: {
                    name: this.customerName.value,
                    phone: this.customerPhone.value,
                    email: this.customerEmail.value,
                    contactType: this.contactType.value,
                    contactDetail: this.contactDetail.value,
                    pickupDate: this.pickupDate.value
                },
                items: items,
                shipping: {
                    method: shippingOption.value,
                    location: backhaulSelect.value || 'N/A',
                    fee: parseInt(backhaulSelect.selectedOptions[0].dataset.fee) || 0
                },
                totalWithShipping: parseInt(document.getElementById('finalTotal').textContent.replace('$', ''))
            };

            fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) })
            .then(() => {
                document.getElementById('successPage').classList.remove('hidden');
                window.scrollTo(0,0);
            });
        });
    </script>
</body>
</html>
